{% extends 'base.html' %}

{% block header %}
Fleet Management
{% endblock %}

{% block content %}
<div class="fleet-metrics">
    <div class="fleet-metric">
        <div class="fleet-metric-header">
            <h4>Total Fleet Size</h4>
            <i class="material-icons">settings</i>
        </div>
        <div class="fleet-metric-value">24</div>
        <div class="fleet-metric-subtitle">
            <i class="material-icons" style="color: #4CAF50;">trending_up</i> 15% growth this quarter
        </div>
    </div>

    <div class="fleet-metric">
        <div class="fleet-metric-header">
            <h4>Average Uptime</h4>
            <i class="material-icons">access_time</i>
        </div>
        <div class="fleet-metric-value">92.5%</div>
        <div class="fleet-metric-subtitle">
            +2.1% from last month
        </div>
    </div>

    <div class="fleet-metric">
        <div class="fleet-metric-header">
            <h4>Maintenance Needed</h4>
            <i class="material-icons">build</i>
        </div>
        <div class="fleet-metric-value">4</div>
        <div class="fleet-metric-subtitle">
            <i class="material-icons" style="color: #F44336;">warning</i> 2 overdue
        </div>
    </div>

    <div class="fleet-metric">
        <div class="fleet-metric-header">
            <h4>Fleet Age</h4>
            <i class="material-icons">event</i>
        </div>
        <div class="fleet-metric-value">2.3</div>
        <div class="fleet-metric-subtitle">
            Average years in service
        </div>
    </div>
</div>

<div class="row">
    <div class="col s12 m8">
        <div class="alert-section">
            <h4>Fleet Location Map</h4>
            <div class="fleet-location-map">
                <div class="map-placeholder">
                    <i class="material-icons" style="font-size: 64px; color: #9E9E9E;">map</i>
                    <p>Robot location map visualization</p>
                </div>
            </div>
        </div>
    </div>

    <div class="col s12 m4">
        <div class="alert-section">
            <h4>Fleet Health</h4>
            <div style="display: flex; justify-content: center; margin: 20px 0;">
                <canvas id="fleet-health-chart" width="200" height="200"></canvas>
            </div>
            <div style="text-align: center; margin-top: 15px;">
                <div style="display: inline-block; margin: 0 10px;">
                    <span style="display: inline-block; width: 15px; height: 15px; background-color: #00C853; border-radius: 50%; margin-right: 5px;"></span>
                    <span style="font-weight: 500;">Optimal</span>
                </div>
                <div style="display: inline-block; margin: 0 10px;">
                    <span style="display: inline-block; width: 15px; height: 15px; background-color: #FFA000; border-radius: 50%; margin-right: 5px;"></span>
                    <span style="font-weight: 500;">Needs Attention</span>
                </div>
                <div style="display: inline-block; margin: 0 10px;">
                    <span style="display: inline-block; width: 15px; height: 15px; background-color: #F44336; border-radius: 50%; margin-right: 5px;"></span>
                    <span style="font-weight: 500;">Critical</span>
                </div>
            </div>
            <div style="display: flex; justify-content: space-around; margin-top: 15px; font-weight: 500;">
                <div>Optimal<br>16</div>
                <div>Needs Attention<br>5</div>
                <div>Critical<br>3</div>
            </div>
        </div>
    </div>
</div>

<div class="alert-section">
    <h4>Robot Groups</h4>
    <div class="robot-groups">
        <div class="robot-group">
            <div class="group-header">
                <h5>Assembly Line</h5>
                <span>8 robots</span>
            </div>
            <div class="group-stats">
                <div><i class="material-icons" style="font-size: 16px; color: #2196F3;">access_time</i> Avg uptime: 94.2%</div>
            </div>
            <div style="display: flex; justify-content: space-between; margin-top: 10px;">
                <div>7 active</div>
                <div>1 down</div>
            </div>
        </div>

        <div class="robot-group">
            <div class="group-header">
                <h5>Warehouse</h5>
                <span>6 robots</span>
            </div>
            <div class="group-stats">
                <div><i class="material-icons" style="font-size: 16px; color: #2196F3;">access_time</i> Avg uptime: 89.7%</div>
            </div>
            <div style="display: flex; justify-content: space-between; margin-top: 10px;">
                <div>5 active</div>
                <div>1 warning</div>
            </div>
        </div>

        <div class="robot-group">
            <div class="group-header">
                <h5>Inspection</h5>
                <span>4 robots</span>
            </div>
            <div class="group-stats">
                <div><i class="material-icons" style="font-size: 16px; color: #2196F3;">access_time</i> Avg uptime: 91.5%</div>
            </div>
            <div style="display: flex; justify-content: space-between; margin-top: 10px;">
                <div>3 active</div>
                <div>1 critical</div>
            </div>
        </div>
    </div>
</div>

<div class="fleet-utilization">
    <h4>Fleet Utilization</h4>
    <div class="utilization-chart">
        <canvas id="utilization-chart" width="400" height="300"></canvas>
    </div>
    <div class="utilization-stats">
        <div class="utilization-stat">
            <div class="utilization-stat-value">78%</div>
            <div class="utilization-stat-label">Peak Utilization</div>
            <div style="font-size: 12px; color: #757575;">Yesterday at 2:45 PM</div>
        </div>
        <div class="utilization-stat">
            <div class="utilization-stat-value">65%</div>
            <div class="utilization-stat-label">Current Utilization</div>
            <div style="font-size: 12px; color: #757575;">Across all robots</div>
        </div>
        <div class="utilization-stat">
            <div class="utilization-stat-value">70-75%</div>
            <div class="utilization-stat-label">Target Utilization</div>
            <div style="font-size: 12px; color: #757575;">Optimal range</div>
        </div>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script>
    document.addEventListener('DOMContentLoaded', function() {
        // Fleet Health Chart
        const healthCtx = document.getElementById('fleet-health-chart').getContext('2d');
        new Chart(healthCtx, {
            type: 'doughnut',
            data: {
                labels: ['Optimal', 'Needs Attention', 'Critical'],
                datasets: [{
                    data: [16, 5, 3],
                    backgroundColor: ['#00C853', '#FFA000', '#F44336'],
                    borderWidth: 0
                }]
            },
            options: {
                cutout: '70%',
                responsive: true,
                plugins: {
                    legend: {
                        display: false
                    }
                }
            }
        });

        // Utilization Chart
        const utilizationCtx = document.getElementById('utilization-chart').getContext('2d');
        new Chart(utilizationCtx, {
            type: 'line',
            data: {
                labels: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul'],
                datasets: [{
                    label: 'Fleet Utilization',
                    data: [45, 52, 58, 62, 65, 68, 65],
                    borderColor: '#2196F3',
                    backgroundColor: 'rgba(33, 150, 243, 0.1)',
                    borderWidth: 2,
                    fill: true,
                    tension: 0.3
                }]
            },
            options: {
                responsive: true,
                scales: {
                    y: {
                        min: 0,
                        max: 100,
                        ticks: {
                            callback: function(value) {
                                return value + '%';
                            }
                        }
                    }
                },
                plugins: {
                    legend: {
                        display: false
                    }
                }
            }
        });
    });
</script>
{% endblock %}